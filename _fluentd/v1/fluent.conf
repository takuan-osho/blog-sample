<source>
  @type tail
  path /var/log/nginx/docker.access.log
  pos_file /tmp/access.log.pos
  format nginx
  tag nginx.access
</source>

<source>
  @type forward
  port 24224
</source>

<label @log>
  <match {nginx}.**>
    @type forward
    require_ack_response

    heartbeat_type transport

    <server>
      host localhost
      port 24224
    </server>

    <buffer tag>
      @type file
      path /tmp/nginx-access.log.forward
      chunk_limit_size 1m
      queue_limit_length 2048
      flush_mode interval
      flush_interval 1s
      retry_forever true
      flush_thread_count 1
    </buffer>
  </match>
</label>
